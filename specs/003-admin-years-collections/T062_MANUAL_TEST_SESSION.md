# T062 鍵盤導航手動驗證 - 測試執行紀錄

**測試日期**: 2025-09-30  
**測試者**: ________________  
**瀏覽器**: Chrome / Safari / Firefox (請圈選)  
**開發伺服器**: ✅ http://localhost:3000 已啟動

---

## 🎯 測試目標

驗證 Admin 頁面符合 **FR-001 鍵盤無障礙性需求**:
- Tab 順序邏輯且焦點可見
- 方向鍵可導航清單項目
- Enter 啟動按鈕, Escape 關閉對話框
- 表單可完全用鍵盤操作
- ARIA live regions 宣告操作結果

---

## 📝 測試步驟

### 第一部分: Admin Years 頁面 (/admin/years)

#### ✅ 測試 1: Tab 順序與焦點可見性

**開啟頁面**: http://localhost:3000/admin/years

**操作**:
1. 點擊瀏覽器網址列確保焦點在頁面外
2. 按 **Tab** 鍵多次
3. 觀察焦點移動順序

**預期結果**:
- [ ] 焦點依序經過: 導航連結 → Create Year 按鈕 → Year 項目 → 操作按鈕
- [ ] 每個獲得焦點的元素有明顯視覺指示 (藍色外框或陰影)
- [ ] 焦點順序符合視覺閱讀順序 (由上到下)

**實際結果**:
```
□ 通過  □ 失敗
失敗原因: _______________________________________________
```

---

#### ✅ 測試 2: 方向鍵導航 Year 清單

**前提**: 頁面已有至少 2 個 Year 項目 (如無,請先用滑鼠建立)

**操作**:
1. 按 **Tab** 直到焦點移至第一個 Year 項目
2. 記下目前焦點的 Year 名稱: _______________
3. 按 **ArrowDown** (向下鍵)
4. 觀察焦點是否移至下一個 Year

**預期結果**:
- [ ] 按 ArrowDown 後焦點移至下一個 Year 項目
- [ ] 焦點移動時有視覺回饋
- [ ] 頁面顯示 "Year order updated" 或類似成功訊息

**操作 (續)**:
5. 按 **ArrowUp** (向上鍵)
6. 觀察焦點是否返回上一個 Year

**預期結果**:
- [ ] 按 ArrowUp 後焦點移回上一個 Year 項目
- [ ] 再次顯示成功訊息

**實際結果**:
```
□ 通過  □ 失敗
失敗原因: _______________________________________________
```

---

#### ✅ 測試 3: Enter 鍵啟動 Create Year 按鈕

**操作**:
1. 按 **Tab** 直到焦點移至 "Create Year" 按鈕
2. 按 **Enter** 鍵

**預期結果**:
- [ ] 對話框 (Dialog) 開啟
- [ ] 焦點自動移至對話框內的第一個輸入欄位

**操作 (續)**:
3. 在 "Label" 欄位輸入測試值,如 "2026"
4. 按 **Tab** 移至 "Save" 按鈕
5. 按 **Enter** 提交

**預期結果**:
- [ ] 對話框關閉
- [ ] 新 Year "2026" 出現在清單中
- [ ] 焦點返回到 "Create Year" 按鈕

**實際結果**:
```
□ 通過  □ 失敗
失敗原因: _______________________________________________
```

---

#### ✅ 測試 4: Escape 鍵關閉對話框

**操作**:
1. 再次按 **Tab** 到 "Create Year" 按鈕並按 **Enter** 開啟對話框
2. 按 **Escape** 鍵

**預期結果**:
- [ ] 對話框立即關閉
- [ ] 焦點返回到 "Create Year" 按鈕 (觸發對話框的元素)
- [ ] 未建立新 Year (因取消操作)

**實際結果**:
```
□ 通過  □ 失敗
失敗原因: _______________________________________________
```

---

#### ✅ 測試 5: Edit Year 對話框鍵盤操作

**操作**:
1. 按 **Tab** 移至任一 Year 項目的 "Edit" 按鈕
2. 按 **Enter** 開啟編輯對話框
3. 按 **Tab** 在欄位間移動 (Label → Status → Save → Cancel)
4. 修改 Label 為 "Updated 2026"
5. 按 **Tab** 到 "Save" 並按 **Enter**

**預期結果**:
- [ ] Tab 能在所有欄位間移動
- [ ] 修改成功儲存
- [ ] 對話框關閉後焦點返回 Edit 按鈕

**實際結果**:
```
□ 通過  □ 失敗
失敗原因: _______________________________________________
```

---

#### ✅ 測試 6: ARIA Live Regions (螢幕閱讀器宣告)

**前提**: 如有螢幕閱讀器 (macOS VoiceOver: Cmd+F5),請開啟

**操作**:
1. 按 **Tab** 移至任一 Year 項目
2. 按 **ArrowDown** 觸發排序

**預期結果**:
- [ ] 頁面顯示成功訊息 (如 "Year 2024 moved to position 2")
- [ ] 螢幕閱讀器宣告新位置 (如有開啟)
- [ ] 檢查 DOM: 頁面應有 `role="status"` 或 `aria-live="polite"` 元素

**檢查方式** (無螢幕閱讀器):
1. 按 **F12** 開啟 DevTools
2. 在 Elements 面板搜尋 `role="status"` 或 `aria-live`
3. 確認該元素存在且內容會更新

**實際結果**:
```
□ 通過  □ 失敗  □ 無法驗證 (需螢幕閱讀器)
失敗原因: _______________________________________________
```

---

### 第二部分: Admin Collections 頁面 (/admin/collections)

#### ✅ 測試 7: Collections Tab 順序

**開啟頁面**: http://localhost:3000/admin/collections

**操作**:
1. 選擇任一 Year (如無 Collection,先用滑鼠建立)
2. 按 **Tab** 多次觀察順序

**預期結果**:
- [ ] 焦點依序經過: Year 選擇器 → Create Collection 按鈕 → Collection 項目
- [ ] 焦點可見性良好

**實際結果**:
```
□ 通過  □ 失敗
失敗原因: _______________________________________________
```

---

#### ✅ 測試 8: Collections 方向鍵導航

**前提**: 當前 Year 有至少 2 個 Collection

**操作**:
1. 按 **Tab** 移至第一個 Collection 項目
2. 按 **ArrowDown** 和 **ArrowUp** 測試導航

**預期結果**:
- [ ] 方向鍵能在 Collection 項目間移動
- [ ] 移動時觸發排序並顯示成功訊息
- [ ] ARIA live region 更新宣告

**實際結果**:
```
□ 通過  □ 失敗
失敗原因: _______________________________________________
```

---

#### ✅ 測試 9: Create Collection 對話框

**操作**:
1. 按 **Tab** 到 "Create Collection" 按鈕
2. 按 **Enter** 開啟對話框
3. 用 **Tab** 在欄位間移動
4. 按 **Escape** 取消

**預期結果**:
- [ ] Enter 開啟對話框
- [ ] Tab 能在所有欄位間移動
- [ ] Escape 關閉對話框並返回焦點

**實際結果**:
```
□ 通過  □ 失敗
失敗原因: _______________________________________________
```

---

## 📊 測試總結

### 通過的測試項目
- [ ] 測試 1: Tab 順序與焦點可見性 (Years)
- [ ] 測試 2: 方向鍵導航 (Years)
- [ ] 測試 3: Enter 鍵啟動 Create Year
- [ ] 測試 4: Escape 鍵關閉對話框
- [ ] 測試 5: Edit Year 鍵盤操作
- [ ] 測試 6: ARIA live regions
- [ ] 測試 7: Tab 順序 (Collections)
- [ ] 測試 8: 方向鍵導航 (Collections)
- [ ] 測試 9: Create Collection 對話框

**通過數量**: _____ / 9

---

### 整體評估

**符合 FR-001 鍵盤無障礙性需求**: □ 是  □ 否  □ 部分符合

**主要問題** (如有):
1. _________________________________________________________________
2. _________________________________________________________________
3. _________________________________________________________________

**建議改進**:
1. _________________________________________________________________
2. _________________________________________________________________

---

### 與 E2E 測試比較

**E2E 測試結果**: 3/9 通過 (環境問題導致頁面載入失敗)

**手動驗證結果**: _____ / 9 通過

**差異分析**:
- E2E 無法測試但手動通過的項目: _______________________________
- 兩者皆失敗的項目: ___________________________________________
- **結論**: 手動驗證 □ 可替代 E2E  □ 需補充自動化測試

---

## 🎬 測試完成後續步驟

1. **儲存此檔案** 並提交測試結果
2. **更新 tasks.md**: 標記 T062 手動驗證完成狀態
3. **如發現問題**: 在 tasks.md 建立修復任務
4. **如全數通過**: T062 視為完成,可進入下階段開發

---

**測試者簽名**: ________________  
**完成時間**: ________________

---

## 📎 附錄: 常見問題

**Q: 焦點完全看不見怎麼辦?**  
A: 檢查 CSS 是否有 `outline: none` 覆蓋預設樣式,建議加入 `:focus-visible` 樣式

**Q: 方向鍵沒有反應?**  
A: 確認焦點確實在 Year/Collection 項目上 (不是按鈕),檢查 `onKeyDown` 事件是否綁定

**Q: 對話框開啟後無法用 Tab?**  
A: 檢查對話框是否使用 `<Dialog>` 元件,是否有 focus trap 機制

**Q: ARIA live region 找不到?**  
A: 搜尋 `role="status"`, `role="alert"`, `aria-live="polite"` 或 `aria-live="assertive"`

---

**對應測試檔案**: `tests/integration/test_admin_keyboard_navigation.ts`  
**參考文件**: `T062_MANUAL_VALIDATION_CHECKLIST.md`  
**規格需求**: `spec.md` FR-001
